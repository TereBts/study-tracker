<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Study Tracker</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f7f7f7;
  margin: 0;
  padding: 20px;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  min-height: 100vh;
}
.tracker {
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  width: 90%;
  max-width: 600px;
}
h1 {
  text-align: center;
  margin-bottom: 20px;
}
.controls {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
  flex-wrap: wrap;
  justify-content: center;
}
select, button {
  padding: 8px;
  border: 1px solid #ccc;
  border-radius: 6px;
}
button {
  background: #4CAF50;
  color: #fff;
  cursor: pointer;
  transition: background 0.3s;
}
button:hover { background: #45a049; }
.progress-container { margin-top: 15px; }
.progress { height: 20px; background: #ddd; border-radius: 10px; overflow: hidden; margin-top:5px; position: relative;}
.progress-bar { height: 100%; background: #4CAF50; width: 0%; transition: width 0.3s ease; }
.totals { text-align: center; margin-top: 5px; font-weight: bold; }
.forecast { text-align: center; margin-top: 10px; font-style: italic; color: #555; }
.log-toggle { margin-top: 15px; display: flex; justify-content: center; }
.log { display: none; margin-top: 10px; max-height: 300px; overflow-y: auto; border-top: 1px solid #ccc; padding-top: 10px; }
.week-divider { font-weight: bold; margin-top: 10px; border-bottom: 1px dashed #ccc; padding-bottom: 3px; }
.entry { background: #f0f0f0; padding: 8px; margin: 5px 0; border-radius: 6px; }
.reset { margin-top: 10px; display: flex; gap: 10px; justify-content: center; }
.reset button { background: #e53935; }
.reset button:hover { background: #c62828; }
</style>
</head>
<body>
<div class="tracker">
  <h1>Study Tracker</h1>
  <div class="controls">
    <select id="daySelect">
      <option value="" disabled selected>Select Day</option>
      <option>Monday</option>
      <option>Tuesday</option>
      <option>Wednesday</option>
      <option>Thursday</option>
      <option>Friday</option>
      <option>Saturday</option>
      <option>Sunday</option>
    </select>

    <select id="hoursSelect">
      <option value="" disabled selected>Hours</option>
      <option value="0.5">0.5</option>
      <option value="1">1</option>
      <option value="1.5">1.5</option>
      <option value="2">2</option>
      <option value="2.5">2.5</option>
      <option value="3">3</option>
    </select>

    <select id="sectionsSelect">
      <option value="" disabled selected>Sections</option>
      <option value="0">0</option>
      <option value="0.5">0.5</option>
      <option value="1">1</option>
      <option value="1.5">1.5</option>
      <option value="2">2</option>
      <option value="2.5">2.5</option>
      <option value="3">3</option>
      <option value="3.5">3.5</option>
      <option value="4">4</option>
      <option value="4.5">4.5</option>
      <option value="5">5</option>
    </select>

    <button onclick="logStudy()">Log</button>
  </div>

  <div class="progress-container">
    <div>Weekly Progress:</div>
    <div class="progress"><div class="progress-bar" id="weeklyProgressBar"></div></div>
    <div class="totals" id="weeklyTotals">0 hours, 0 sections / 7.5 this week</div>
  </div>

  <div class="progress-container">
    <div>Overall Progress:</div>
    <div class="progress"><div class="progress-bar" id="overallProgressBar"></div></div>
    <div class="totals" id="overallTotals">0 hours, 0 sections / 45 total</div>
  </div>

  <div class="forecast" id="forecast"></div>

  <div class="reset">
    <button onclick="resetWeek()">Reset Week</button>
    <button onclick="toggleLogs()">Toggle Logs</button>
  </div>

  <div class="log" id="log"></div>
</div>

<script>
const weeklyGoal = 7.5;   // weekly sections
const totalGoal = 45;      // milestone sections
const totalWeeks = 10;
const projectWeeks = 4;
const studyWeeks = totalWeeks - projectWeeks; // 6 weeks
const idealWeeklyPace = totalGoal / studyWeeks; // 7.5

let weeklyHours = 0;
let weeklySections = 0;
let overallHours = 0;
let overallSections = 0;
let weeklyLog = [];

// Load saved data
window.onload = () => {
  const saved = JSON.parse(localStorage.getItem("studyData"));
  if(saved){
    weeklyHours = saved.weeklyHours;
    weeklySections = saved.weeklySections;
    overallHours = saved.overallHours;
    overallSections = saved.overallSections;
    weeklyLog = saved.weeklyLog || [];
    renderLog();
    updateDisplay();
  }
};

function logStudy(){
  const day = document.getElementById("daySelect").value;
  const hours = parseFloat(document.getElementById("hoursSelect").value);
  const sections = parseFloat(document.getElementById("sectionsSelect").value);

  if(!day || isNaN(hours) || isNaN(sections)){
    alert("Please select day, hours, and sections.");
    return;
  }

  weeklyHours += hours;
  weeklySections += sections;
  overallHours += hours;
  overallSections += sections;

  weeklyLog.push({day,hours,sections,week:getCurrentWeek()});

  renderLog();
  updateDisplay();
  saveData();

  document.getElementById("daySelect").selectedIndex = 0;
  document.getElementById("hoursSelect").selectedIndex = 0;
  document.getElementById("sectionsSelect").selectedIndex = 0;
}

function renderLog(){
  const logDiv = document.getElementById("log");
  logDiv.innerHTML = '';

  const currentWeek = getCurrentWeek();

  // Current week
  const currentWeekHeader = document.createElement('div');
  currentWeekHeader.classList.add('week-divider');
  currentWeekHeader.textContent = 'Current Week';
  logDiv.appendChild(currentWeekHeader);

  weeklyLog.filter(e=>e.week===currentWeek).forEach(e=>{
    const entry = document.createElement('div');
    entry.classList.add('entry');
    entry.textContent = `${e.day}: ${e.hours} hours, ${e.sections} sections`;
    logDiv.appendChild(entry);
  });

  // Previous weeks
  const prevEntries = weeklyLog.filter(e=>e.week<currentWeek);
  if(prevEntries.length){
    const prevHeader = document.createElement('div');
    prevHeader.classList.add('week-divider');
    prevHeader.textContent = 'Previous Weeks';
    logDiv.appendChild(prevHeader);
    prevEntries.forEach(e=>{
      const entry = document.createElement('div');
      entry.classList.add('entry');
      entry.textContent = `${e.day}: ${e.hours} hours, ${e.sections} sections`;
      logDiv.appendChild(entry);
    });
  }
}

function getCurrentWeek(){
  const today = new Date();
  const startDate = new Date(); // adjust to actual course start date if desired
  const diffTime = today - startDate;
  return Math.floor(diffTime / (7*24*60*60*1000)) + 1; // week 1-based
}

function toggleLogs(){
  const logDiv = document.getElementById("log");
  logDiv.style.display = (logDiv.style.display==='none')?'block':'none';
}

function updateDisplay(){
  document.getElementById("weeklyTotals").textContent = `${weeklyHours} hours, ${weeklySections} sections this week`;
  document.getElementById("weeklyProgressBar").style.width = Math.min((weeklySections/weeklyGoal)*100,100) + "%";

  document.getElementById("overallTotals").textContent = `${overallHours} hours, ${overallSections} sections total`;
  document.getElementById("overallProgressBar").style.width = Math.min((overallSections/totalGoal)*100,100) + "%";

  // Forecast
  const weeksElapsed = Math.ceil(overallSections/idealWeeklyPace);
  const remainingSections = totalGoal - overallSections;
  const avgPerWeek = weeksElapsed? overallSections/weeksElapsed : idealWeeklyPace;
  const weeksLeft = remainingSections/avgPerWeek;
  const forecastDate = new Date();
  forecastDate.setDate(forecastDate.getDate() + Math.ceil(weeksLeft*7));

  // Status
  let status='';
  if(avgPerWeek>idealWeeklyPace) status='ahead';
  else if(avgPerWeek===idealWeeklyPace) status='on track';
  else status='behind';

  const forecastElement = document.getElementById("forecast");
  forecastElement.textContent = `Forecast: You will reach your milestone around ${forecastDate.toDateString()} (${status
